<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 880 460" fill="none">
  <style>
    .title { font: 700 13px system-ui, -apple-system, sans-serif; fill: #e6edf3; }
    .section-title { font: 700 10px system-ui, sans-serif; letter-spacing: 0.06em; }
    .box-label { font: 600 10.5px system-ui, sans-serif; fill: #e6edf3; }
    .box-sub { font: 400 9px system-ui, sans-serif; fill: #8b949e; }
    .arrow-label { font: 500 8px system-ui, sans-serif; fill: #6e7681; }
    .footer { font: 500 9px system-ui, sans-serif; fill: #6e7681; }
  </style>
  <defs>
    <marker id="a1" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff" opacity="0.6"/>
    </marker>
    <marker id="a2" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#d29922" opacity="0.6"/>
    </marker>
    <marker id="a3" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f47067" opacity="0.6"/>
    </marker>
    <marker id="a4" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3fb950" opacity="0.6"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="880" height="460" rx="12" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="440" y="28" text-anchor="middle" class="title">How agent-bom works</text>

  <!-- ═══ Phase 1: Discovery (left column) ═══ -->
  <rect x="16" y="42" width="170" height="280" rx="8" fill="#161b22" stroke="#58a6ff" stroke-width="1" opacity="0.8"/>
  <text x="101" y="58" text-anchor="middle" class="section-title" fill="#58a6ff">DISCOVERY</text>

  <rect x="28" y="66" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="101" y="80" text-anchor="middle" class="box-label">MCP Configs</text>
  <text x="101" y="90" text-anchor="middle" class="box-sub">18 clients · auto-detect</text>

  <rect x="28" y="100" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="101" y="114" text-anchor="middle" class="box-label">Cloud Providers</text>
  <text x="101" y="124" text-anchor="middle" class="box-sub">AWS · Azure · GCP · Snowflake</text>

  <rect x="28" y="134" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="101" y="148" text-anchor="middle" class="box-label">Docker Images</text>
  <text x="101" y="158" text-anchor="middle" class="box-sub">Grype + Syft deep scan</text>

  <rect x="28" y="168" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="101" y="182" text-anchor="middle" class="box-label">Kubernetes</text>
  <text x="101" y="192" text-anchor="middle" class="box-sub">Multi-namespace pod scan</text>

  <rect x="28" y="202" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="101" y="216" text-anchor="middle" class="box-label">Existing SBOMs</text>
  <text x="101" y="226" text-anchor="middle" class="box-sub">CycloneDX + SPDX import</text>

  <rect x="28" y="236" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="101" y="250" text-anchor="middle" class="box-label">Agent Frameworks</text>
  <text x="101" y="260" text-anchor="middle" class="box-sub">LangChain · CrewAI · ADK</text>

  <rect x="28" y="280" width="146" height="32" rx="5" fill="#0d1117" stroke="#58a6ff" stroke-width="1" opacity="0.4"/>
  <text x="101" y="294" text-anchor="middle" class="box-sub">→ Agents · Servers</text>
  <text x="101" y="306" text-anchor="middle" class="box-sub">→ Packages · Credentials · Tools</text>

  <!-- Arrow: Discovery → Enrichment -->
  <line x1="186" y1="180" x2="210" y2="180" stroke="#58a6ff" stroke-width="2" marker-end="url(#a1)"/>

  <!-- ═══ Phase 2: Enrichment (center-left) ═══ -->
  <rect x="214" y="42" width="170" height="280" rx="8" fill="#161b22" stroke="#d29922" stroke-width="1" opacity="0.8"/>
  <text x="299" y="58" text-anchor="middle" class="section-title" fill="#d29922">ENRICHMENT</text>

  <rect x="226" y="66" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="299" y="80" text-anchor="middle" class="box-label">OSV.dev</text>
  <text x="299" y="90" text-anchor="middle" class="box-sub">Batch CVE lookup · all ecosystems</text>

  <rect x="226" y="100" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="299" y="114" text-anchor="middle" class="box-label">NVD / NIST</text>
  <text x="299" y="124" text-anchor="middle" class="box-sub">CVSS v3.1 + v4.0 scoring</text>

  <rect x="226" y="134" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="299" y="148" text-anchor="middle" class="box-label">FIRST EPSS</text>
  <text x="299" y="158" text-anchor="middle" class="box-sub">Exploit probability scores</text>

  <rect x="226" y="168" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="299" y="182" text-anchor="middle" class="box-label">CISA KEV</text>
  <text x="299" y="192" text-anchor="middle" class="box-sub">Known exploited vulns</text>

  <rect x="226" y="202" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="299" y="216" text-anchor="middle" class="box-label">GHSA + NVIDIA CSAF</text>
  <text x="299" y="226" text-anchor="middle" class="box-sub">Supplemental advisories</text>

  <rect x="226" y="236" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="299" y="250" text-anchor="middle" class="box-label">MCP Registry</text>
  <text x="299" y="260" text-anchor="middle" class="box-sub">427+ server provenance</text>

  <rect x="226" y="280" width="146" height="32" rx="5" fill="#0d1117" stroke="#d29922" stroke-width="1" opacity="0.4"/>
  <text x="299" y="294" text-anchor="middle" class="box-sub">→ CVEs with CVSS + EPSS</text>
  <text x="299" y="306" text-anchor="middle" class="box-sub">→ KEV flags · Fixed versions</text>

  <!-- Arrow: Enrichment → Analysis -->
  <line x1="384" y1="180" x2="408" y2="180" stroke="#d29922" stroke-width="2" marker-end="url(#a2)"/>

  <!-- ═══ Phase 3: Analysis (center-right) ═══ -->
  <rect x="412" y="42" width="170" height="280" rx="8" fill="#161b22" stroke="#f47067" stroke-width="1" opacity="0.8"/>
  <text x="497" y="58" text-anchor="middle" class="section-title" fill="#f47067">ANALYSIS</text>

  <rect x="424" y="66" width="146" height="40" rx="5" fill="#0d1117" stroke="#f47067" stroke-width="1" opacity="0.6"/>
  <text x="497" y="82" text-anchor="middle" class="box-label">Blast Radius</text>
  <text x="497" y="96" text-anchor="middle" class="box-sub">CVE → pkg → server → agent → creds → tools</text>

  <rect x="424" y="114" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="497" y="128" text-anchor="middle" class="box-label">OWASP LLM Top 10</text>
  <text x="497" y="138" text-anchor="middle" class="box-sub">LLM02 · LLM05 · LLM06 · LLM08</text>

  <rect x="424" y="148" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="497" y="162" text-anchor="middle" class="box-label">OWASP MCP Top 10</text>
  <text x="497" y="172" text-anchor="middle" class="box-sub">MCP01–MCP10 tagging</text>

  <rect x="424" y="182" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="497" y="196" text-anchor="middle" class="box-label">MITRE ATLAS</text>
  <text x="497" y="206" text-anchor="middle" class="box-sub">AI adversarial threat mapping</text>

  <rect x="424" y="216" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="497" y="230" text-anchor="middle" class="box-label">NIST AI RMF</text>
  <text x="497" y="240" text-anchor="middle" class="box-sub">Risk management framework</text>

  <rect x="424" y="250" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="497" y="264" text-anchor="middle" class="box-label">Enforcement Engine</text>
  <text x="497" y="274" text-anchor="middle" class="box-sub">Tool poisoning + policy gates</text>

  <rect x="424" y="284" width="146" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="497" y="298" text-anchor="middle" class="box-label">Model Provenance</text>
  <text x="497" y="308" text-anchor="middle" class="box-sub">SHA-256 · Sigstore · HuggingFace</text>

  <!-- Arrow: Analysis → Output -->
  <line x1="582" y1="180" x2="606" y2="180" stroke="#f47067" stroke-width="2" marker-end="url(#a3)"/>

  <!-- ═══ Phase 4: Output (right) ═══ -->
  <rect x="610" y="42" width="130" height="280" rx="8" fill="#161b22" stroke="#3fb950" stroke-width="1" opacity="0.8"/>
  <text x="675" y="58" text-anchor="middle" class="section-title" fill="#3fb950">OUTPUT</text>

  <rect x="622" y="66" width="106" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="675" y="80" text-anchor="middle" class="box-label">Console + HTML</text>
  <text x="675" y="90" text-anchor="middle" class="box-sub">Rich tables + dashboard</text>

  <rect x="622" y="100" width="106" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="675" y="114" text-anchor="middle" class="box-label">SARIF</text>
  <text x="675" y="124" text-anchor="middle" class="box-sub">GitHub Security tab</text>

  <rect x="622" y="134" width="106" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="675" y="148" text-anchor="middle" class="box-label">CycloneDX 1.6</text>
  <text x="675" y="158" text-anchor="middle" class="box-sub">AI-BOM standard</text>

  <rect x="622" y="168" width="106" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="675" y="182" text-anchor="middle" class="box-label">SPDX 3.0</text>
  <text x="675" y="192" text-anchor="middle" class="box-sub">License + provenance</text>

  <rect x="622" y="202" width="106" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="675" y="216" text-anchor="middle" class="box-label">JSON + Mermaid</text>
  <text x="675" y="226" text-anchor="middle" class="box-sub">Machine-readable</text>

  <rect x="622" y="240" width="106" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="675" y="254" text-anchor="middle" class="box-label">REST API</text>
  <text x="675" y="264" text-anchor="middle" class="box-sub">FastAPI on :8422</text>

  <!-- ═══ Interfaces (far right) ═══ -->
  <rect x="756" y="42" width="108" height="280" rx="8" fill="#161b22" stroke="#a371f7" stroke-width="1" opacity="0.8"/>
  <text x="810" y="58" text-anchor="middle" class="section-title" fill="#a371f7">INTERFACES</text>

  <rect x="764" y="70" width="92" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="810" y="84" text-anchor="middle" class="box-label">CLI</text>
  <text x="810" y="94" text-anchor="middle" class="box-sub">pip install agent-bom</text>

  <rect x="764" y="106" width="92" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="810" y="120" text-anchor="middle" class="box-label">MCP Server</text>
  <text x="810" y="130" text-anchor="middle" class="box-sub">13 tools · stdio/SSE</text>

  <rect x="764" y="142" width="92" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="810" y="156" text-anchor="middle" class="box-label">GitHub Action</text>
  <text x="810" y="166" text-anchor="middle" class="box-sub">CI/CD integration</text>

  <rect x="764" y="178" width="92" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="810" y="192" text-anchor="middle" class="box-label">Cloud UI</text>
  <text x="810" y="202" text-anchor="middle" class="box-sub">Next.js dashboard</text>

  <rect x="764" y="214" width="92" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="810" y="228" text-anchor="middle" class="box-label">Snowflake</text>
  <text x="810" y="238" text-anchor="middle" class="box-sub">Streamlit + Native App</text>

  <!-- Arrow: Output → Interfaces -->
  <line x1="740" y1="180" x2="752" y2="180" stroke="#3fb950" stroke-width="2" marker-end="url(#a4)"/>

  <!-- ═══ Trust bar ═══ -->
  <rect x="16" y="338" width="848" height="36" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="440" y="354" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9.5" font-weight="700" fill="#8b949e" letter-spacing="0.05em">TRUST PRINCIPLES</text>
  <text x="440" y="368" text-anchor="middle" class="footer">Read-only  ·  Agentless  ·  Never writes configs  ·  Never runs MCP servers  ·  Never stores credentials  ·  Sigstore-signed releases</text>

  <!-- ═══ Data flow legend ═══ -->
  <rect x="16" y="384" width="848" height="66" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="440" y="400" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9.5" font-weight="700" fill="#8b949e" letter-spacing="0.05em">DATA FLOW</text>

  <!-- Flow arrows in legend -->
  <line x1="80" y1="420" x2="110" y2="420" stroke="#58a6ff" stroke-width="2" marker-end="url(#a1)"/>
  <text x="118" y="424" class="footer" fill="#58a6ff">Discover</text>

  <line x1="200" y1="420" x2="230" y2="420" stroke="#d29922" stroke-width="2" marker-end="url(#a2)"/>
  <text x="238" y="424" class="footer" fill="#d29922">Enrich</text>

  <line x1="310" y1="420" x2="340" y2="420" stroke="#f47067" stroke-width="2" marker-end="url(#a3)"/>
  <text x="348" y="424" class="footer" fill="#f47067">Analyze</text>

  <line x1="420" y1="420" x2="450" y2="420" stroke="#3fb950" stroke-width="2" marker-end="url(#a4)"/>
  <text x="458" y="424" class="footer" fill="#3fb950">Report</text>

  <text x="440" y="442" text-anchor="middle" class="footer">MCP Client Configs → Agents + Servers + Packages → OSV + NVD + EPSS + KEV + GHSA → Blast Radius + OWASP + ATLAS → SARIF / CycloneDX / SPDX / JSON</text>
</svg>