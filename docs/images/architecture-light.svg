<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 620" fill="none">
  <style>
    .title { font: 700 13px system-ui, -apple-system, sans-serif; fill: #1f2328; }
    .section-title { font: 700 10px system-ui, sans-serif; letter-spacing: 0.06em; }
    .box-label { font: 600 10.5px system-ui, sans-serif; fill: #1f2328; }
    .box-sub { font: 400 9px system-ui, sans-serif; fill: #656d76; }
    .arrow-label { font: 500 8px system-ui, sans-serif; fill: #656d76; }
    .footer { font: 500 9px system-ui, sans-serif; fill: #656d76; }
    .trust-label { font: 700 11px system-ui, sans-serif; fill: #424a53; letter-spacing: 0.06em; }
    .trust-pill { font: 600 9.5px system-ui, sans-serif; fill: #1f2328; }
    .flow-title { font: 700 10px system-ui, sans-serif; fill: #424a53; letter-spacing: 0.06em; }
    .flow-zone { font: 700 9px system-ui, sans-serif; letter-spacing: 0.04em; }
    .flow-detail { font: 400 8.5px system-ui, sans-serif; fill: #656d76; }
    .flow-arrow { font: 600 8.5px system-ui, sans-serif; }
  </style>
  <defs>
    <marker id="a1" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#0969da" opacity="0.6"/>
    </marker>
    <marker id="a2" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#bf8700" opacity="0.6"/>
    </marker>
    <marker id="a3" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#cf222e" opacity="0.6"/>
    </marker>
    <marker id="a4" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#1a7f37" opacity="0.6"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="960" height="620" rx="12" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="480" y="28" text-anchor="middle" class="title">How agent-bom works</text>

  <!-- ═══ Phase 1: Discovery (x=16, w=170) ═══ -->
  <rect x="16" y="44" width="170" height="366" rx="8" fill="#f6f8fa" stroke="#0969da" stroke-width="1" opacity="0.8"/>
  <text x="101" y="60" text-anchor="middle" class="section-title" fill="#0969da">DISCOVERY</text>

  <rect x="28" y="68" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="101" y="84" text-anchor="middle" class="box-label">MCP Configs</text>
  <text x="101" y="96" text-anchor="middle" class="box-sub">18 clients · auto-detect</text>

  <rect x="28" y="106" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="101" y="122" text-anchor="middle" class="box-label">Cloud Providers</text>
  <text x="101" y="134" text-anchor="middle" class="box-sub">AWS · Azure · GCP · Snowflake</text>

  <rect x="28" y="144" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="101" y="160" text-anchor="middle" class="box-label">Docker Images</text>
  <text x="101" y="172" text-anchor="middle" class="box-sub">Grype + Syft deep scan</text>

  <rect x="28" y="182" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="101" y="198" text-anchor="middle" class="box-label">Kubernetes</text>
  <text x="101" y="210" text-anchor="middle" class="box-sub">Multi-namespace pod scan</text>

  <rect x="28" y="220" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="101" y="236" text-anchor="middle" class="box-label">Existing SBOMs</text>
  <text x="101" y="248" text-anchor="middle" class="box-sub">CycloneDX + SPDX import</text>

  <rect x="28" y="258" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="101" y="274" text-anchor="middle" class="box-label">Agent Frameworks</text>
  <text x="101" y="286" text-anchor="middle" class="box-sub">LangChain · CrewAI · ADK</text>

  <rect x="28" y="302" width="146" height="36" rx="5" fill="#ffffff" stroke="#0969da" stroke-width="1" opacity="0.4"/>
  <text x="101" y="318" text-anchor="middle" class="box-sub">Agents · Servers</text>
  <text x="101" y="332" text-anchor="middle" class="box-sub">Packages · Credentials · Tools</text>

  <line x1="186" y1="227" x2="212" y2="227" stroke="#0969da" stroke-width="2" marker-end="url(#a1)"/>

  <!-- ═══ Phase 2: Enrichment (x=216, w=170) ═══ -->
  <rect x="216" y="44" width="170" height="366" rx="8" fill="#f6f8fa" stroke="#bf8700" stroke-width="1" opacity="0.8"/>
  <text x="301" y="60" text-anchor="middle" class="section-title" fill="#bf8700">ENRICHMENT</text>

  <rect x="228" y="68" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="301" y="84" text-anchor="middle" class="box-label">OSV.dev</text>
  <text x="301" y="96" text-anchor="middle" class="box-sub">Batch CVE lookup · all ecosystems</text>

  <rect x="228" y="106" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="301" y="122" text-anchor="middle" class="box-label">NVD / NIST</text>
  <text x="301" y="134" text-anchor="middle" class="box-sub">CVSS v3.1 + v4.0 scoring</text>

  <rect x="228" y="144" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="301" y="160" text-anchor="middle" class="box-label">FIRST EPSS</text>
  <text x="301" y="172" text-anchor="middle" class="box-sub">Exploit probability scores</text>

  <rect x="228" y="182" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="301" y="198" text-anchor="middle" class="box-label">CISA KEV</text>
  <text x="301" y="210" text-anchor="middle" class="box-sub">Known exploited vulns</text>

  <rect x="228" y="220" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="301" y="236" text-anchor="middle" class="box-label">GHSA + NVIDIA CSAF</text>
  <text x="301" y="248" text-anchor="middle" class="box-sub">Supplemental advisories</text>

  <rect x="228" y="258" width="146" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="301" y="274" text-anchor="middle" class="box-label">MCP Registry</text>
  <text x="301" y="286" text-anchor="middle" class="box-sub">427+ server provenance</text>

  <rect x="228" y="302" width="146" height="36" rx="5" fill="#ffffff" stroke="#bf8700" stroke-width="1" opacity="0.4"/>
  <text x="301" y="318" text-anchor="middle" class="box-sub">CVEs with CVSS + EPSS</text>
  <text x="301" y="332" text-anchor="middle" class="box-sub">KEV flags · Fixed versions</text>

  <line x1="386" y1="227" x2="412" y2="227" stroke="#bf8700" stroke-width="2" marker-end="url(#a2)"/>

  <!-- ═══ Phase 3: Analysis (x=416, w=180) ═══ -->
  <rect x="416" y="44" width="180" height="366" rx="8" fill="#f6f8fa" stroke="#cf222e" stroke-width="1" opacity="0.8"/>
  <text x="506" y="60" text-anchor="middle" class="section-title" fill="#cf222e">ANALYSIS</text>

  <rect x="428" y="68" width="156" height="40" rx="5" fill="#ffffff" stroke="#cf222e" stroke-width="1" opacity="0.6"/>
  <text x="506" y="84" text-anchor="middle" class="box-label">Blast Radius</text>
  <text x="506" y="100" text-anchor="middle" class="box-sub">CVE → pkg → server → agent → creds → tools</text>

  <rect x="428" y="114" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="130" text-anchor="middle" class="box-label">OWASP LLM Top 10</text>
  <text x="506" y="142" text-anchor="middle" class="box-sub">LLM02 · LLM05 · LLM06 · LLM08</text>

  <rect x="428" y="152" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="168" text-anchor="middle" class="box-label">OWASP MCP Top 10</text>
  <text x="506" y="180" text-anchor="middle" class="box-sub">MCP01-MCP10 tagging</text>

  <rect x="428" y="190" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="206" text-anchor="middle" class="box-label">MITRE ATLAS</text>
  <text x="506" y="218" text-anchor="middle" class="box-sub">AI adversarial threat mapping</text>

  <rect x="428" y="228" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="244" text-anchor="middle" class="box-label">NIST AI RMF</text>
  <text x="506" y="256" text-anchor="middle" class="box-sub">Risk management framework</text>

  <rect x="428" y="266" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="282" text-anchor="middle" class="box-label">OWASP Agentic Top 10</text>
  <text x="506" y="294" text-anchor="middle" class="box-sub">ASI01-ASI10 agent risks</text>

  <rect x="428" y="304" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="320" text-anchor="middle" class="box-label">EU AI Act</text>
  <text x="506" y="332" text-anchor="middle" class="box-sub">ART-5 through ART-17</text>

  <rect x="428" y="342" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="358" text-anchor="middle" class="box-label">Enforcement Engine</text>
  <text x="506" y="370" text-anchor="middle" class="box-sub">Tool poisoning + policy gates</text>

  <rect x="428" y="380" width="156" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="506" y="396" text-anchor="middle" class="box-label">Model Provenance</text>
  <text x="506" y="332" text-anchor="middle" class="box-sub">SHA-256 · Sigstore · HuggingFace</text>

  <line x1="596" y1="227" x2="622" y2="227" stroke="#cf222e" stroke-width="2" marker-end="url(#a3)"/>

  <!-- ═══ Phase 4: Output (x=626, w=140) ═══ -->
  <rect x="626" y="44" width="140" height="366" rx="8" fill="#f6f8fa" stroke="#1a7f37" stroke-width="1" opacity="0.8"/>
  <text x="696" y="60" text-anchor="middle" class="section-title" fill="#1a7f37">OUTPUT</text>

  <rect x="638" y="68" width="116" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="696" y="84" text-anchor="middle" class="box-label">Console + HTML</text>
  <text x="696" y="96" text-anchor="middle" class="box-sub">Rich tables + dashboard</text>

  <rect x="638" y="106" width="116" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="696" y="122" text-anchor="middle" class="box-label">SARIF</text>
  <text x="696" y="134" text-anchor="middle" class="box-sub">GitHub Security tab</text>

  <rect x="638" y="144" width="116" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="696" y="160" text-anchor="middle" class="box-label">CycloneDX 1.6</text>
  <text x="696" y="172" text-anchor="middle" class="box-sub">AI-BOM standard</text>

  <rect x="638" y="182" width="116" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="696" y="198" text-anchor="middle" class="box-label">SPDX 3.0</text>
  <text x="696" y="210" text-anchor="middle" class="box-sub">License + provenance</text>

  <rect x="638" y="220" width="116" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="696" y="236" text-anchor="middle" class="box-label">JSON + Graph</text>
  <text x="696" y="248" text-anchor="middle" class="box-sub">Cytoscape + React Flow</text>

  <rect x="638" y="258" width="116" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="696" y="274" text-anchor="middle" class="box-label">REST API</text>
  <text x="696" y="286" text-anchor="middle" class="box-sub">FastAPI on :8422</text>

  <line x1="766" y1="227" x2="792" y2="227" stroke="#1a7f37" stroke-width="2" marker-end="url(#a4)"/>

  <!-- ═══ Phase 5: Interfaces (x=796, w=148) ═══ -->
  <rect x="796" y="44" width="148" height="366" rx="8" fill="#f6f8fa" stroke="#8250df" stroke-width="1" opacity="0.8"/>
  <text x="870" y="60" text-anchor="middle" class="section-title" fill="#8250df">INTERFACES</text>

  <rect x="808" y="68" width="124" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="870" y="84" text-anchor="middle" class="box-label">CLI</text>
  <text x="870" y="96" text-anchor="middle" class="box-sub">pip install agent-bom</text>

  <rect x="808" y="106" width="124" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="870" y="122" text-anchor="middle" class="box-label">MCP Server</text>
  <text x="870" y="134" text-anchor="middle" class="box-sub">14 tools · stdio/SSE</text>

  <rect x="808" y="144" width="124" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="870" y="160" text-anchor="middle" class="box-label">GitHub Action</text>
  <text x="870" y="172" text-anchor="middle" class="box-sub">CI/CD integration</text>

  <rect x="808" y="182" width="124" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="870" y="198" text-anchor="middle" class="box-label">Cloud UI</text>
  <text x="870" y="210" text-anchor="middle" class="box-sub">Next.js dashboard</text>

  <rect x="808" y="220" width="124" height="32" rx="5" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="870" y="236" text-anchor="middle" class="box-label">Snowflake</text>
  <text x="870" y="248" text-anchor="middle" class="box-sub">Streamlit + Native App</text>

  <!-- ═══ Trust Principles (y=420, h=56) — enlarged ═══ -->
  <rect x="16" y="420" width="928" height="56" rx="8" fill="#f6f8fa" stroke="#1a7f37" stroke-width="1" opacity="0.6"/>
  <text x="480" y="438" text-anchor="middle" class="trust-label" fill="#1a7f37">TRUST PRINCIPLES</text>
  <rect x="48" y="446" width="90" height="22" rx="11" fill="#ffffff" stroke="#1a7f37" stroke-width="1" opacity="0.5"/>
  <text x="93" y="460" text-anchor="middle" class="trust-pill">Read-only</text>
  <rect x="150" y="446" width="90" height="22" rx="11" fill="#ffffff" stroke="#1a7f37" stroke-width="1" opacity="0.5"/>
  <text x="195" y="460" text-anchor="middle" class="trust-pill">Agentless</text>
  <rect x="252" y="446" width="140" height="22" rx="11" fill="#ffffff" stroke="#1a7f37" stroke-width="1" opacity="0.5"/>
  <text x="322" y="460" text-anchor="middle" class="trust-pill">Never writes configs</text>
  <rect x="404" y="446" width="150" height="22" rx="11" fill="#ffffff" stroke="#1a7f37" stroke-width="1" opacity="0.5"/>
  <text x="479" y="460" text-anchor="middle" class="trust-pill">Never runs MCP servers</text>
  <rect x="566" y="446" width="160" height="22" rx="11" fill="#ffffff" stroke="#1a7f37" stroke-width="1" opacity="0.5"/>
  <text x="646" y="460" text-anchor="middle" class="trust-pill">Never stores credentials</text>
  <rect x="738" y="446" width="130" height="22" rx="11" fill="#ffffff" stroke="#1a7f37" stroke-width="1" opacity="0.5"/>
  <text x="803" y="460" text-anchor="middle" class="trust-pill">Sigstore-signed</text>

  <!-- ═══ Data Flow (y=486, h=120) — expanded with 3 zones ═══ -->
  <rect x="16" y="486" width="928" height="120" rx="8" fill="#f6f8fa" stroke="#d1d9e0" stroke-width="1"/>
  <text x="480" y="504" text-anchor="middle" class="flow-title">DATA FLOW</text>

  <rect x="32" y="514" width="260" height="78" rx="6" fill="#ffffff" stroke="#0969da" stroke-width="1" opacity="0.5"/>
  <text x="162" y="530" text-anchor="middle" class="flow-zone" fill="#0969da">YOUR MACHINE (READ-ONLY)</text>
  <text x="162" y="546" text-anchor="middle" class="flow-detail">Extracted: server names, package names,</text>
  <text x="162" y="558" text-anchor="middle" class="flow-detail">env var names, tool lists</text>
  <text x="162" y="574" text-anchor="middle" class="flow-detail" fill="#cf222e">Never extracted: secrets, tokens, passwords</text>
  <text x="162" y="586" text-anchor="middle" class="flow-detail" fill="#1a7f37">--dry-run previews everything first</text>

  <line x1="296" y1="553" x2="326" y2="553" stroke="#0969da" stroke-width="2" marker-end="url(#a1)"/>

  <rect x="330" y="514" width="280" height="78" rx="6" fill="#ffffff" stroke="#bf8700" stroke-width="1" opacity="0.5"/>
  <text x="470" y="530" text-anchor="middle" class="flow-zone" fill="#bf8700">AGENT-BOM ENGINE</text>
  <text x="470" y="546" text-anchor="middle" class="flow-detail">Sends to APIs: package names + versions only</text>
  <text x="470" y="560" text-anchor="middle" class="flow-detail">Blast radius · Threat models · Enforcement</text>
  <text x="470" y="574" text-anchor="middle" class="flow-detail">OWASP + ATLAS + NIST + EU AI Act framework tagging</text>
  <text x="470" y="586" text-anchor="middle" class="flow-detail" fill="#cf222e">No credentials leave your machine</text>

  <line x1="614" y1="553" x2="644" y2="553" stroke="#bf8700" stroke-width="2" marker-end="url(#a2)"/>

  <rect x="648" y="514" width="280" height="78" rx="6" fill="#ffffff" stroke="#cf222e" stroke-width="1" opacity="0.5"/>
  <text x="788" y="530" text-anchor="middle" class="flow-zone" fill="#cf222e">PUBLIC APIs (READ-ONLY)</text>
  <text x="788" y="546" text-anchor="middle" class="flow-detail">OSV.dev · NVD · FIRST EPSS · CISA KEV</text>
  <text x="788" y="560" text-anchor="middle" class="flow-detail">GitHub Security Advisories · NVIDIA CSAF</text>
  <text x="788" y="574" text-anchor="middle" class="flow-detail">Receives: package name + version + ecosystem</text>
  <text x="788" y="586" text-anchor="middle" class="flow-detail" fill="#1a7f37">Returns: CVEs, CVSS, EPSS, KEV, fix versions</text>
</svg>
