<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 880 460" fill="none">
  <style>
    .title { font: 700 15px system-ui, -apple-system, sans-serif; fill: #e6edf3; }
    .subtitle { font: 400 11px system-ui, sans-serif; fill: #8b949e; }
    .phase-label { font: 700 9px system-ui, sans-serif; letter-spacing: 0.1em; }
    .node-name { font: 600 11px system-ui, sans-serif; }
    .node-detail { font: 400 9px system-ui, sans-serif; fill: #8b949e; }
    .badge { font: 700 8px 'SF Mono', monospace; }
    .tag { font: 600 8.5px 'SF Mono', monospace; }
    .flow-line { stroke-width: 2; fill: none; }
    .dim-line { stroke: #30363d; stroke-width: 1; fill: none; }
    .footer { font: 400 10px system-ui, -apple-system, sans-serif; fill: #6e7681; }
  </style>
  <defs>
    <marker id="arr-red" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <path d="M0 0L10 3.5L0 7Z" fill="#ef4444"/>
    </marker>
    <linearGradient id="glow-red" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#ef4444" stop-opacity="0.15"/>
      <stop offset="100%" stop-color="#ef4444" stop-opacity="0"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="880" height="460" rx="12" fill="#0d1117" stroke="#30363d" stroke-width="1"/>

  <!-- Title -->
  <text x="440" y="32" text-anchor="middle" class="title">Attack Path Visualization</text>
  <text x="440" y="50" text-anchor="middle" class="subtitle">How a vulnerable dependency leads to credential exposure and tool compromise</text>

  <!-- ═══ Phase labels ═══ -->
  <text x="92" y="80" text-anchor="middle" class="phase-label" fill="#f85149">VULNERABLE PACKAGE</text>
  <text x="268" y="80" text-anchor="middle" class="phase-label" fill="#f0883e">MCP SERVER</text>
  <text x="444" y="80" text-anchor="middle" class="phase-label" fill="#d29922">AI AGENT</text>
  <text x="620" y="80" text-anchor="middle" class="phase-label" fill="#f85149">EXPOSED CREDENTIALS</text>
  <text x="796" y="80" text-anchor="middle" class="phase-label" fill="#da3633">COMPROMISED TOOLS</text>

  <!-- ═══ Node 1: Vulnerable Package ═══ -->
  <rect x="24" y="92" width="136" height="72" rx="10" fill="#1c0a0a" stroke="#f85149" stroke-width="2"/>
  <text x="92" y="114" text-anchor="middle" class="node-name" fill="#f85149">axios@1.6.0</text>
  <line x1="44" y1="122" x2="140" y2="122" class="dim-line" stroke="#f85149" stroke-opacity="0.3"/>
  <text x="92" y="138" text-anchor="middle" font-family="'SF Mono', monospace" font-size="9" font-weight="600" fill="#f87171">CVE-2024-39338</text>
  <rect x="56" y="144" width="72" height="14" rx="3" fill="#3d0d0d" stroke="#f85149" stroke-width="0.8"/>
  <text x="92" y="154" text-anchor="middle" class="badge" fill="#f87171">HIGH</text>

  <!-- Arrow 1→2 -->
  <line x1="160" y1="128" x2="196" y2="128" class="flow-line" stroke="#ef4444" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 2: MCP Server ═══ -->
  <rect x="200" y="92" width="136" height="72" rx="10" fill="#1a1208" stroke="#f0883e" stroke-width="1.5"/>
  <text x="268" y="114" text-anchor="middle" class="node-name" fill="#f0883e">github-mcp-server</text>
  <line x1="220" y1="122" x2="316" y2="122" class="dim-line" stroke="#f0883e" stroke-opacity="0.3"/>
  <text x="268" y="138" text-anchor="middle" class="node-detail">12 tools exposed</text>
  <text x="268" y="152" text-anchor="middle" class="node-detail">stdio transport</text>

  <!-- Arrow 2→3 -->
  <line x1="336" y1="128" x2="372" y2="128" class="flow-line" stroke="#ef4444" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 3: AI Agent ═══ -->
  <rect x="376" y="92" width="136" height="72" rx="10" fill="#1a1508" stroke="#d29922" stroke-width="1.5"/>
  <text x="444" y="114" text-anchor="middle" class="node-name" fill="#d29922">Claude Desktop</text>
  <line x1="396" y1="122" x2="492" y2="122" class="dim-line" stroke="#d29922" stroke-opacity="0.3"/>
  <text x="444" y="138" text-anchor="middle" class="node-detail">3 MCP servers</text>
  <text x="444" y="152" text-anchor="middle" class="node-detail">configured</text>

  <!-- Arrow 3→4 -->
  <line x1="512" y1="128" x2="548" y2="128" class="flow-line" stroke="#ef4444" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 4: Exposed Credentials ═══ -->
  <rect x="552" y="92" width="136" height="72" rx="10" fill="#1c0a0a" stroke="#f85149" stroke-width="1.5"/>
  <text x="620" y="114" text-anchor="middle" class="node-name" fill="#f85149">GITHUB_TOKEN</text>
  <line x1="572" y1="122" x2="668" y2="122" class="dim-line" stroke="#f85149" stroke-opacity="0.3"/>
  <text x="620" y="140" text-anchor="middle" class="node-name" fill="#f87171">SLACK_BOT_TOKEN</text>
  <rect x="576" y="148" width="88" height="14" rx="3" fill="#3d0d0d" stroke="#f85149" stroke-width="0.8"/>
  <text x="620" y="158" text-anchor="middle" class="badge" fill="#f87171">LEAKED</text>

  <!-- Arrow 4→5 -->
  <line x1="688" y1="128" x2="724" y2="128" class="flow-line" stroke="#ef4444" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 5: Compromised Tools ═══ -->
  <rect x="728" y="92" width="136" height="72" rx="10" fill="#2d0809" stroke="#da3633" stroke-width="2"/>
  <text x="796" y="112" text-anchor="middle" class="node-name" fill="#da3633">create_issue</text>
  <text x="796" y="128" text-anchor="middle" class="node-name" fill="#da3633">push_files</text>
  <line x1="748" y1="136" x2="844" y2="136" class="dim-line" stroke="#da3633" stroke-opacity="0.3"/>
  <text x="796" y="152" text-anchor="middle" class="node-name" fill="#f87171">execute_command</text>

  <!-- ═══ Propagation glow bar ═══ -->
  <rect x="24" y="176" width="840" height="4" rx="2" fill="url(#glow-red)"/>
  <rect x="24" y="176" width="840" height="4" rx="2" fill="#ef4444" opacity="0.08"/>

  <!-- ═══ Arrow labels along the chain ═══ -->
  <text x="178" y="118" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" fill="#ef4444">&#x2192;</text>
  <text x="354" y="118" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" fill="#ef4444">&#x2192;</text>
  <text x="530" y="118" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" fill="#ef4444">&#x2192;</text>
  <text x="706" y="118" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" fill="#ef4444">&#x2192;</text>

  <!-- ═══ Blast Radius Summary Box ═══ -->
  <rect x="24" y="200" width="840" height="200" rx="10" fill="#161b22" stroke="#30363d" stroke-width="1"/>

  <!-- Blast Radius title -->
  <text x="440" y="228" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="700" fill="#e6edf3">Blast Radius Summary</text>

  <!-- Three columns layout -->

  <!-- Column 1: Risk Score -->
  <rect x="52" y="248" width="240" height="120" rx="8" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="172" y="274" text-anchor="middle" class="phase-label" fill="#ef4444">RISK SCORE</text>

  <text x="172" y="316" text-anchor="middle" font-family="system-ui, sans-serif" font-size="42" font-weight="700" fill="#ef4444">8.5</text>
  <text x="172" y="338" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#8b949e">/10</text>

  <!-- Risk bar -->
  <rect x="82" y="350" width="180" height="6" rx="3" fill="#21262d"/>
  <rect x="82" y="350" width="153" height="6" rx="3" fill="#ef4444"/>

  <!-- Column 2: Compliance -->
  <rect x="320" y="248" width="240" height="120" rx="8" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="440" y="274" text-anchor="middle" class="phase-label" fill="#a78bfa">COMPLIANCE</text>

  <rect x="348" y="288" width="84" height="22" rx="4" fill="#1e1536" stroke="#8b5cf6" stroke-width="0.8"/>
  <text x="390" y="303" text-anchor="middle" class="tag" fill="#c4b5fd">OWASP LLM05</text>

  <rect x="442" y="288" width="92" height="22" rx="4" fill="#1e1536" stroke="#8b5cf6" stroke-width="0.8"/>
  <text x="488" y="303" text-anchor="middle" class="tag" fill="#c4b5fd">MCP04</text>

  <rect x="378" y="322" width="124" height="22" rx="4" fill="#0c1a1a" stroke="#22d3ee" stroke-width="0.8"/>
  <text x="440" y="337" text-anchor="middle" class="tag" fill="#67e8f9">ATLAS AML.T0010</text>

  <!-- Column 3: EPSS -->
  <rect x="588" y="248" width="248" height="120" rx="8" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="712" y="274" text-anchor="middle" class="phase-label" fill="#f59e0b">EXPLOITATION PROBABILITY</text>

  <text x="712" y="316" text-anchor="middle" font-family="system-ui, sans-serif" font-size="42" font-weight="700" fill="#f59e0b">45%</text>
  <text x="712" y="338" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#8b949e">EPSS score</text>

  <!-- EPSS bar -->
  <rect x="628" y="350" width="168" height="6" rx="3" fill="#21262d"/>
  <rect x="628" y="350" width="76" height="6" rx="3" fill="#f59e0b"/>

  <!-- ═══ Footer ═══ -->
  <text x="440" y="440" text-anchor="middle" class="footer">agent-bom maps every path from vulnerable dependency to exposed capability</text>
</svg>