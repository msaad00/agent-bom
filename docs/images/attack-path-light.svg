<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 880 460" fill="none">
  <style>
    .title { font: 700 15px system-ui, -apple-system, sans-serif; fill: #1f2328; }
    .subtitle { font: 400 11px system-ui, sans-serif; fill: #656d76; }
    .phase-label { font: 700 9px system-ui, sans-serif; letter-spacing: 0.1em; }
    .node-name { font: 600 11px system-ui, sans-serif; }
    .node-detail { font: 400 9px system-ui, sans-serif; fill: #656d76; }
    .badge { font: 700 8px 'SF Mono', monospace; }
    .tag { font: 600 8.5px 'SF Mono', monospace; }
    .flow-line { stroke-width: 2; fill: none; }
    .dim-line { stroke: #d1d9e0; stroke-width: 1; fill: none; }
    .footer { font: 400 10px system-ui, -apple-system, sans-serif; fill: #656d76; }
  </style>
  <defs>
    <marker id="arr-red" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <path d="M0 0L10 3.5L0 7Z" fill="#cf222e"/>
    </marker>
    <linearGradient id="glow-red" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#cf222e" stop-opacity="0.1"/>
      <stop offset="100%" stop-color="#cf222e" stop-opacity="0"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="880" height="460" rx="12" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>

  <!-- Title -->
  <text x="440" y="32" text-anchor="middle" class="title">Attack Path Visualization</text>
  <text x="440" y="50" text-anchor="middle" class="subtitle">How a vulnerable dependency leads to credential exposure and tool compromise</text>

  <!-- ═══ Phase labels ═══ -->
  <text x="92" y="80" text-anchor="middle" class="phase-label" fill="#cf222e">VULNERABLE PACKAGE</text>
  <text x="268" y="80" text-anchor="middle" class="phase-label" fill="#bc4c00">MCP SERVER</text>
  <text x="444" y="80" text-anchor="middle" class="phase-label" fill="#9a6700">AI AGENT</text>
  <text x="620" y="80" text-anchor="middle" class="phase-label" fill="#cf222e">EXPOSED CREDENTIALS</text>
  <text x="796" y="80" text-anchor="middle" class="phase-label" fill="#a40e26">COMPROMISED TOOLS</text>

  <!-- ═══ Node 1: Vulnerable Package ═══ -->
  <rect x="24" y="92" width="136" height="72" rx="10" fill="#ffebe9" stroke="#cf222e" stroke-width="2"/>
  <text x="92" y="114" text-anchor="middle" class="node-name" fill="#a40e26">axios@1.6.0</text>
  <line x1="44" y1="122" x2="140" y2="122" class="dim-line" stroke="#cf222e" stroke-opacity="0.3"/>
  <text x="92" y="138" text-anchor="middle" font-family="'SF Mono', monospace" font-size="9" font-weight="600" fill="#a40e26">CVE-2024-39338</text>
  <rect x="56" y="144" width="72" height="14" rx="3" fill="#ffebe9" stroke="#cf222e" stroke-width="0.8"/>
  <text x="92" y="154" text-anchor="middle" class="badge" fill="#cf222e">HIGH</text>

  <!-- Arrow 1→2 -->
  <line x1="160" y1="128" x2="196" y2="128" class="flow-line" stroke="#cf222e" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 2: MCP Server ═══ -->
  <rect x="200" y="92" width="136" height="72" rx="10" fill="#fff1e5" stroke="#bc4c00" stroke-width="1.5"/>
  <text x="268" y="114" text-anchor="middle" class="node-name" fill="#953800">github-mcp-server</text>
  <line x1="220" y1="122" x2="316" y2="122" class="dim-line" stroke="#bc4c00" stroke-opacity="0.3"/>
  <text x="268" y="138" text-anchor="middle" class="node-detail">12 tools exposed</text>
  <text x="268" y="152" text-anchor="middle" class="node-detail">stdio transport</text>

  <!-- Arrow 2→3 -->
  <line x1="336" y1="128" x2="372" y2="128" class="flow-line" stroke="#cf222e" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 3: AI Agent ═══ -->
  <rect x="376" y="92" width="136" height="72" rx="10" fill="#fff8c5" stroke="#9a6700" stroke-width="1.5"/>
  <text x="444" y="114" text-anchor="middle" class="node-name" fill="#7d4e00">Claude Desktop</text>
  <line x1="396" y1="122" x2="492" y2="122" class="dim-line" stroke="#9a6700" stroke-opacity="0.3"/>
  <text x="444" y="138" text-anchor="middle" class="node-detail">3 MCP servers</text>
  <text x="444" y="152" text-anchor="middle" class="node-detail">configured</text>

  <!-- Arrow 3→4 -->
  <line x1="512" y1="128" x2="548" y2="128" class="flow-line" stroke="#cf222e" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 4: Exposed Credentials ═══ -->
  <rect x="552" y="92" width="136" height="72" rx="10" fill="#ffebe9" stroke="#cf222e" stroke-width="1.5"/>
  <text x="620" y="114" text-anchor="middle" class="node-name" fill="#a40e26">GITHUB_TOKEN</text>
  <line x1="572" y1="122" x2="668" y2="122" class="dim-line" stroke="#cf222e" stroke-opacity="0.3"/>
  <text x="620" y="140" text-anchor="middle" class="node-name" fill="#a40e26">SLACK_BOT_TOKEN</text>
  <rect x="576" y="148" width="88" height="14" rx="3" fill="#ffebe9" stroke="#cf222e" stroke-width="0.8"/>
  <text x="620" y="158" text-anchor="middle" class="badge" fill="#cf222e">LEAKED</text>

  <!-- Arrow 4→5 -->
  <line x1="688" y1="128" x2="724" y2="128" class="flow-line" stroke="#cf222e" marker-end="url(#arr-red)"/>

  <!-- ═══ Node 5: Compromised Tools ═══ -->
  <rect x="728" y="92" width="136" height="72" rx="10" fill="#ffebe9" stroke="#a40e26" stroke-width="2"/>
  <text x="796" y="112" text-anchor="middle" class="node-name" fill="#a40e26">create_issue</text>
  <text x="796" y="128" text-anchor="middle" class="node-name" fill="#a40e26">push_files</text>
  <line x1="748" y1="136" x2="844" y2="136" class="dim-line" stroke="#a40e26" stroke-opacity="0.3"/>
  <text x="796" y="152" text-anchor="middle" class="node-name" fill="#82071e">execute_command</text>

  <!-- ═══ Propagation glow bar ═══ -->
  <rect x="24" y="176" width="840" height="4" rx="2" fill="url(#glow-red)"/>
  <rect x="24" y="176" width="840" height="4" rx="2" fill="#cf222e" opacity="0.06"/>

  <!-- ═══ Blast Radius Summary Box ═══ -->
  <rect x="24" y="200" width="840" height="200" rx="10" fill="#f6f8fa" stroke="#d1d9e0" stroke-width="1"/>

  <!-- Blast Radius title -->
  <text x="440" y="228" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="13" font-weight="700" fill="#1f2328">Blast Radius Summary</text>

  <!-- Three columns layout -->

  <!-- Column 1: Risk Score -->
  <rect x="52" y="248" width="240" height="120" rx="8" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="172" y="274" text-anchor="middle" class="phase-label" fill="#cf222e">RISK SCORE</text>

  <text x="172" y="316" text-anchor="middle" font-family="system-ui, sans-serif" font-size="42" font-weight="700" fill="#cf222e">8.5</text>
  <text x="172" y="338" text-anchor="middle" font-family="system-ui, sans-serif" font-size="14" font-weight="600" fill="#656d76">/10</text>

  <!-- Risk bar -->
  <rect x="82" y="350" width="180" height="6" rx="3" fill="#e1e4e8"/>
  <rect x="82" y="350" width="153" height="6" rx="3" fill="#cf222e"/>

  <!-- Column 2: Compliance -->
  <rect x="320" y="248" width="240" height="120" rx="8" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="440" y="274" text-anchor="middle" class="phase-label" fill="#8250df">COMPLIANCE</text>

  <rect x="348" y="288" width="84" height="22" rx="4" fill="#fbefff" stroke="#8250df" stroke-width="0.8"/>
  <text x="390" y="303" text-anchor="middle" class="tag" fill="#6639ba">OWASP LLM05</text>

  <rect x="442" y="288" width="92" height="22" rx="4" fill="#fbefff" stroke="#8250df" stroke-width="0.8"/>
  <text x="488" y="303" text-anchor="middle" class="tag" fill="#6639ba">MCP04</text>

  <rect x="378" y="322" width="124" height="22" rx="4" fill="#ddf4ff" stroke="#0969da" stroke-width="0.8"/>
  <text x="440" y="337" text-anchor="middle" class="tag" fill="#0550ae">ATLAS AML.T0010</text>

  <!-- Column 3: EPSS -->
  <rect x="588" y="248" width="248" height="120" rx="8" fill="#ffffff" stroke="#d1d9e0" stroke-width="1"/>
  <text x="712" y="274" text-anchor="middle" class="phase-label" fill="#bf8700">EXPLOITATION PROBABILITY</text>

  <text x="712" y="316" text-anchor="middle" font-family="system-ui, sans-serif" font-size="42" font-weight="700" fill="#bf8700">45%</text>
  <text x="712" y="338" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="600" fill="#656d76">EPSS score</text>

  <!-- EPSS bar -->
  <rect x="628" y="350" width="168" height="6" rx="3" fill="#e1e4e8"/>
  <rect x="628" y="350" width="76" height="6" rx="3" fill="#bf8700"/>

  <!-- ═══ Footer ═══ -->
  <text x="440" y="440" text-anchor="middle" class="footer">agent-bom maps every path from vulnerable dependency to exposed capability</text>
</svg>