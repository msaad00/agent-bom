<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 560" fill="none">
  <defs>
    <linearGradient id="agentG" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#dbeafe"/>
      <stop offset="100%" stop-color="#bfdbfe"/>
    </linearGradient>
    <linearGradient id="serverG" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#e0e7ff"/>
      <stop offset="100%" stop-color="#c7d2fe"/>
    </linearGradient>
    <linearGradient id="toolG" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fef3c7"/>
      <stop offset="100%" stop-color="#fde68a"/>
    </linearGradient>
    <linearGradient id="pkgG" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d1fae5"/>
      <stop offset="100%" stop-color="#a7f3d0"/>
    </linearGradient>
    <linearGradient id="vulnG" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fecaca"/>
      <stop offset="100%" stop-color="#fca5a5"/>
    </linearGradient>
    <linearGradient id="owaspG" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fce7f3"/>
      <stop offset="100%" stop-color="#fbcfe8"/>
    </linearGradient>
    <filter id="sh" x="-4%" y="-4%" width="108%" height="108%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-opacity="0.08"/>
    </filter>
    <marker id="arrowGray" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94a3b8"/>
    </marker>
    <marker id="arrowRed" viewBox="0 0 10 7" refX="10" refY="3.5" markerWidth="8" markerHeight="6" orient="auto-start-auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#ef4444"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="560" rx="16" fill="#fafafa" stroke="#e5e7eb" stroke-width="1"/>

  <!-- Title -->
  <text x="450" y="32" text-anchor="middle" font-family="system-ui, -apple-system, sans-serif" font-size="15" font-weight="700" fill="#1f2937">Blast Radius — How one CVE exposes your entire AI stack</text>
  <text x="450" y="50" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" fill="#6b7280">Example: CVE-2024-XXXX in an MCP server dependency grants access to tools, credentials, and data</text>

  <!-- ═══ Row labels (left) ═══ -->
  <text x="12" y="112" font-family="system-ui, sans-serif" font-size="10" font-weight="700" fill="#475569" transform="rotate(-90, 12, 112)">AGENT</text>
  <text x="12" y="242" font-family="system-ui, sans-serif" font-size="10" font-weight="700" fill="#475569" transform="rotate(-90, 12, 242)">MCP SERVER</text>
  <text x="12" y="360" font-family="system-ui, sans-serif" font-size="10" font-weight="700" fill="#475569" transform="rotate(-90, 12, 360)">TOOLS</text>
  <text x="12" y="478" font-family="system-ui, sans-serif" font-size="10" font-weight="700" fill="#475569" transform="rotate(-90, 12, 478)">VULNS</text>

  <!-- ═══ Layer 1: AI Agents ═══ -->
  <g filter="url(#sh)">
    <rect x="40" y="68" width="200" height="70" rx="10" fill="url(#agentG)" stroke="#93c5fd" stroke-width="1.5"/>
  </g>
  <text x="140" y="92" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="700" fill="#1e40af">Claude Desktop</text>
  <text x="140" y="108" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#3b82f6">claude_desktop_config.json</text>
  <text x="140" y="126" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">env: OPENAI_API_KEY=sk-***</text>

  <g filter="url(#sh)">
    <rect x="280" y="68" width="200" height="70" rx="10" fill="url(#agentG)" stroke="#93c5fd" stroke-width="1.5"/>
  </g>
  <text x="380" y="92" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="700" fill="#1e40af">Cursor IDE</text>
  <text x="380" y="108" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#3b82f6">~/.cursor/mcp.json</text>
  <text x="380" y="126" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">env: ANTHROPIC_KEY=ant-***</text>

  <g filter="url(#sh)">
    <rect x="520" y="68" width="200" height="70" rx="10" fill="url(#agentG)" stroke="#93c5fd" stroke-width="1.5"/>
  </g>
  <text x="620" y="92" text-anchor="middle" font-family="system-ui, sans-serif" font-size="13" font-weight="700" fill="#1e40af">Windsurf</text>
  <text x="620" y="108" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" fill="#3b82f6">~/.codeium/mcp_config.json</text>
  <text x="620" y="126" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">env: AWS_SECRET=AKIA***</text>

  <!-- ═══ Arrows: Agents → Servers ═══ -->
  <line x1="140" y1="138" x2="140" y2="193" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="380" y1="138" x2="330" y2="193" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="380" y1="138" x2="560" y2="193" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="620" y1="138" x2="560" y2="193" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="620" y1="138" x2="770" y2="193" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>

  <!-- ═══ Layer 2: MCP Servers ═══ -->
  <g filter="url(#sh)">
    <rect x="50" y="198" width="180" height="68" rx="10" fill="url(#serverG)" stroke="#a5b4fc" stroke-width="1.5"/>
  </g>
  <text x="140" y="220" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="#3730a3">filesystem-server</text>
  <text x="140" y="236" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#6366f1">@modelcontextprotocol/</text>
  <text x="140" y="254" text-anchor="middle" font-family="monospace" font-size="9" fill="#22c55e">✓ Verified</text>

  <g filter="url(#sh)">
    <rect x="250" y="198" width="180" height="68" rx="10" fill="url(#serverG)" stroke="#a5b4fc" stroke-width="1.5"/>
  </g>
  <text x="340" y="220" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="#3730a3">sqlite-mcp</text>
  <text x="340" y="236" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#6366f1">community/sqlite-mcp</text>
  <text x="340" y="254" text-anchor="middle" font-family="monospace" font-size="9" fill="#ef4444">⚠ Unverified</text>

  <g filter="url(#sh)">
    <rect x="470" y="198" width="180" height="68" rx="10" fill="url(#serverG)" stroke="#a5b4fc" stroke-width="1.5"/>
  </g>
  <text x="560" y="220" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="#3730a3">puppeteer-server</text>
  <text x="560" y="236" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#6366f1">@anthropic/puppeteer</text>
  <text x="560" y="254" text-anchor="middle" font-family="monospace" font-size="9" fill="#22c55e">✓ Verified</text>

  <g filter="url(#sh)">
    <rect x="680" y="198" width="180" height="68" rx="10" fill="url(#serverG)" stroke="#a5b4fc" stroke-width="1.5"/>
  </g>
  <text x="770" y="220" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="#3730a3">custom-deploy</text>
  <text x="770" y="236" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#6366f1">internal/deploy-bot</text>
  <text x="770" y="254" text-anchor="middle" font-family="monospace" font-size="9" fill="#ef4444">⚠ Unverified</text>

  <!-- ═══ Arrows: Servers → Tools ═══ -->
  <line x1="140" y1="266" x2="100" y2="310" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="140" y1="266" x2="210" y2="310" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="340" y1="266" x2="320" y2="310" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="560" y1="266" x2="450" y2="310" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="560" y1="266" x2="560" y2="310" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="770" y1="266" x2="680" y2="310" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>
  <line x1="770" y1="266" x2="800" y2="310" stroke="#94a3b8" stroke-width="1.5" marker-end="url(#arrowGray)"/>

  <!-- ═══ Layer 3: Tools ═══ -->
  <g filter="url(#sh)">
    <rect x="50" y="314" width="100" height="48" rx="8" fill="url(#toolG)" stroke="#fcd34d" stroke-width="1.5"/>
  </g>
  <text x="100" y="335" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#78350f">read_file</text>
  <text x="100" y="352" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">LLM07</text>

  <g filter="url(#sh)">
    <rect x="160" y="314" width="100" height="48" rx="8" fill="url(#toolG)" stroke="#fcd34d" stroke-width="1.5"/>
  </g>
  <text x="210" y="335" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#78350f">write_file</text>
  <text x="210" y="352" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">LLM02</text>

  <g filter="url(#sh)">
    <rect x="270" y="314" width="100" height="48" rx="8" fill="url(#toolG)" stroke="#fcd34d" stroke-width="1.5"/>
  </g>
  <text x="320" y="335" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#78350f">query_db</text>
  <text x="320" y="352" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">LLM06</text>

  <g filter="url(#sh)">
    <rect x="400" y="314" width="100" height="48" rx="8" fill="url(#toolG)" stroke="#fcd34d" stroke-width="1.5"/>
  </g>
  <text x="450" y="335" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#78350f">navigate</text>
  <text x="450" y="352" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">LLM02</text>

  <g filter="url(#sh)">
    <rect x="510" y="314" width="100" height="48" rx="8" fill="url(#toolG)" stroke="#fcd34d" stroke-width="1.5"/>
  </g>
  <text x="560" y="335" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#78350f">screenshot</text>
  <text x="560" y="352" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#92400e">LLM06</text>

  <g filter="url(#sh)">
    <rect x="630" y="314" width="110" height="48" rx="8" fill="url(#toolG)" stroke="#fcd34d" stroke-width="1.5"/>
  </g>
  <text x="685" y="335" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#78350f">run_shell</text>
  <text x="685" y="352" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#dc2626" font-weight="700">LLM08 !</text>

  <g filter="url(#sh)">
    <rect x="750" y="314" width="110" height="48" rx="8" fill="url(#toolG)" stroke="#fcd34d" stroke-width="1.5"/>
  </g>
  <text x="805" y="335" text-anchor="middle" font-family="system-ui, sans-serif" font-size="11" font-weight="600" fill="#78350f">deploy</text>
  <text x="805" y="352" text-anchor="middle" font-family="system-ui, sans-serif" font-size="8" fill="#dc2626" font-weight="700">LLM08 !</text>

  <!-- ═══ Layer 4: Packages + Vulns (bottom) ═══ -->
  <!-- Package row -->
  <g filter="url(#sh)">
    <rect x="50" y="400" width="160" height="44" rx="8" fill="url(#pkgG)" stroke="#6ee7b7" stroke-width="1.5"/>
  </g>
  <text x="130" y="418" text-anchor="middle" font-family="monospace" font-size="10" font-weight="600" fill="#065f46">glob@7.1.6</text>
  <text x="130" y="434" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#047857">npm • SHA512 ✓</text>

  <g filter="url(#sh)">
    <rect x="230" y="400" width="160" height="44" rx="8" fill="url(#pkgG)" stroke="#6ee7b7" stroke-width="1.5"/>
  </g>
  <text x="310" y="418" text-anchor="middle" font-family="monospace" font-size="10" font-weight="600" fill="#065f46">better-sqlite3@9.0</text>
  <text x="310" y="434" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#047857">npm • SHA512 ✓</text>

  <g filter="url(#sh)">
    <rect x="410" y="400" width="160" height="44" rx="8" fill="url(#pkgG)" stroke="#6ee7b7" stroke-width="1.5"/>
  </g>
  <text x="490" y="418" text-anchor="middle" font-family="monospace" font-size="10" font-weight="600" fill="#065f46">puppeteer@21.6.0</text>
  <text x="490" y="434" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#047857">npm • SLSA ✓</text>

  <g filter="url(#sh)">
    <rect x="590" y="400" width="160" height="44" rx="8" fill="url(#pkgG)" stroke="#6ee7b7" stroke-width="1.5"/>
  </g>
  <text x="670" y="418" text-anchor="middle" font-family="monospace" font-size="10" font-weight="600" fill="#065f46">langchain@0.1.5</text>
  <text x="670" y="434" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#047857">pypi • SHA256 ✓</text>

  <!-- Arrows: Tools → Packages -->
  <line x1="100" y1="362" x2="130" y2="396" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#arrowGray)"/>
  <line x1="320" y1="362" x2="310" y2="396" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#arrowGray)"/>
  <line x1="450" y1="362" x2="490" y2="396" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#arrowGray)"/>
  <line x1="560" y1="362" x2="490" y2="396" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#arrowGray)"/>
  <line x1="685" y1="362" x2="670" y2="396" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#arrowGray)"/>
  <line x1="805" y1="362" x2="670" y2="396" stroke="#94a3b8" stroke-width="1.2" marker-end="url(#arrowGray)"/>

  <!-- ═══ Vulnerability callouts ═══ -->
  <!-- CVE on better-sqlite3 -->
  <g filter="url(#sh)">
    <rect x="220" y="462" width="180" height="50" rx="8" fill="url(#vulnG)" stroke="#ef4444" stroke-width="2"/>
  </g>
  <text x="310" y="480" text-anchor="middle" font-family="monospace" font-size="10" font-weight="700" fill="#dc2626">CVE-2024-XXXX</text>
  <text x="310" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#991b1b">CRITICAL 9.8 • EPSS 87% • KEV</text>
  <line x1="310" y1="444" x2="310" y2="458" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowRed)"/>

  <!-- CVE on puppeteer -->
  <g filter="url(#sh)">
    <rect x="420" y="462" width="180" height="50" rx="8" fill="url(#vulnG)" stroke="#ef4444" stroke-width="2"/>
  </g>
  <text x="510" y="480" text-anchor="middle" font-family="monospace" font-size="10" font-weight="700" fill="#dc2626">GHSA-abc-123</text>
  <text x="510" y="500" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" fill="#991b1b">HIGH 7.5 • EPSS 12%</text>
  <line x1="490" y1="444" x2="500" y2="458" stroke="#ef4444" stroke-width="2" marker-end="url(#arrowRed)"/>

  <!-- OWASP tag legend -->
  <g filter="url(#sh)">
    <rect x="640" y="462" width="240" height="84" rx="8" fill="url(#owaspG)" stroke="#f9a8d4" stroke-width="1.5"/>
  </g>
  <text x="760" y="480" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="700" fill="#831843">OWASP LLM Top 10 Tags</text>
  <text x="654" y="496" font-family="monospace" font-size="9" fill="#6b21a8">LLM02</text>
  <text x="700" y="496" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">Insecure Output</text>
  <text x="654" y="510" font-family="monospace" font-size="9" fill="#6b21a8">LLM05</text>
  <text x="700" y="510" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">Supply Chain Vulns</text>
  <text x="654" y="524" font-family="monospace" font-size="9" fill="#6b21a8">LLM06</text>
  <text x="700" y="524" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">Info Disclosure</text>
  <text x="654" y="538" font-family="monospace" font-size="9" fill="#dc2626">LLM08</text>
  <text x="700" y="538" font-family="system-ui, sans-serif" font-size="9" fill="#64748b">Excessive Agency</text>

  <!-- Red blast radius highlight zone -->
  <rect x="218" y="194" width="216" height="328" rx="12" fill="none" stroke="#ef4444" stroke-width="2" stroke-dasharray="6 3" opacity="0.5"/>
  <text x="326" y="540" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" font-weight="700" fill="#dc2626">BLAST RADIUS</text>
</svg>
