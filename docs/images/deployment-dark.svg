<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 920 520" fill="none">
  <defs>
    <marker id="arrow-right-blue" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
      <path d="M0,0 L6,3 L0,6" fill="none" stroke="#58a6ff" stroke-width="1"/>
    </marker>
    <marker id="arrow-right-green" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
      <path d="M0,0 L6,3 L0,6" fill="none" stroke="#3fb950" stroke-width="1"/>
    </marker>
  </defs>

  <style>
    .title { font: 700 15px system-ui, -apple-system, sans-serif; fill: #e6edf3; }
    .section-label { font: 700 10px system-ui, sans-serif; letter-spacing: 0.08em; }
    .node-label { font: 600 10.5px system-ui, sans-serif; fill: #e6edf3; }
    .node-sub { font: 400 9px system-ui, sans-serif; fill: #8b949e; }
    .bus-left { stroke: #58a6ff; stroke-width: 1.5; fill: none; opacity: 0.5; }
    .bus-right { stroke: #3fb950; stroke-width: 1.5; fill: none; opacity: 0.5; }
    .conn-left { stroke: #58a6ff; stroke-width: 1.5; fill: none; opacity: 0.7; }
    .conn-right { stroke: #3fb950; stroke-width: 1.5; fill: none; opacity: 0.7; }
    .footer { font: 500 9px system-ui, sans-serif; fill: #6e7681; }
  </style>

  <!-- Background -->
  <rect width="920" height="520" rx="12" fill="#0d1117" stroke="#30363d" stroke-width="1"/>

  <!-- Title -->
  <text x="460" y="30" text-anchor="middle" class="title">Enterprise deployment topology</text>

  <!-- ================================================================== -->
  <!-- LEFT COLUMN: Scan Sources  (x=30..230)                            -->
  <!-- ================================================================== -->

  <rect x="20" y="48" width="220" height="6" rx="3" fill="#58a6ff" opacity="0.6"/>
  <text x="130" y="72" text-anchor="middle" class="section-label" fill="#58a6ff">SCAN SOURCES</text>

  <!-- Source 1: Cloud APIs  (y=86, h=44, midY=108) -->
  <g transform="translate(30, 86)">
    <rect width="200" height="44" rx="6" fill="#161b22" stroke="#1f6feb" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="22" r="5" fill="#58a6ff" opacity="0.5"/>
    <text x="28" y="18" class="node-label">Cloud Provider APIs</text>
    <text x="28" y="32" class="node-sub">AWS Bedrock, Snowflake Cortex,</text>
    <text x="28" y="42" class="node-sub">Databricks, Azure, GCP, Nebius</text>
  </g>

  <!-- Source 2: MCP Configs  (y=140, h=36, midY=158) -->
  <g transform="translate(30, 140)">
    <rect width="200" height="36" rx="6" fill="#161b22" stroke="#1f6feb" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="18" r="5" fill="#58a6ff" opacity="0.5"/>
    <text x="28" y="15" class="node-label">MCP Agent Configs</text>
    <text x="28" y="28" class="node-sub">18 clients: Claude, Cursor, Codex, Gemini...</text>
  </g>

  <!-- Source 3: Container Images  (y=186, h=36, midY=204) -->
  <g transform="translate(30, 186)">
    <rect width="200" height="36" rx="6" fill="#161b22" stroke="#1f6feb" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="18" r="5" fill="#58a6ff" opacity="0.5"/>
    <text x="28" y="15" class="node-label">Container Images</text>
    <text x="28" y="28" class="node-sub">Grype / Syft deep scanning</text>
  </g>

  <!-- Source 4: Kubernetes  (y=232, h=36, midY=250) -->
  <g transform="translate(30, 232)">
    <rect width="200" height="36" rx="6" fill="#161b22" stroke="#1f6feb" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="18" r="5" fill="#58a6ff" opacity="0.5"/>
    <text x="28" y="15" class="node-label">Kubernetes Clusters</text>
    <text x="28" y="28" class="node-sub">kubectl multi-namespace pods</text>
  </g>

  <!-- Source 5: IaC + CI  (y=278, h=36, midY=296) -->
  <g transform="translate(30, 278)">
    <rect width="200" height="36" rx="6" fill="#161b22" stroke="#1f6feb" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="18" r="5" fill="#58a6ff" opacity="0.5"/>
    <text x="28" y="15" class="node-label">IaC + CI/CD</text>
    <text x="28" y="28" class="node-sub">Terraform, GitHub Actions</text>
  </g>

  <!-- Source 6: SBOMs  (y=324, h=36, midY=342) -->
  <g transform="translate(30, 324)">
    <rect width="200" height="36" rx="6" fill="#161b22" stroke="#1f6feb" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="18" r="5" fill="#58a6ff" opacity="0.5"/>
    <text x="28" y="15" class="node-label">SBOMs + Agent Frameworks</text>
    <text x="28" y="28" class="node-sub">CycloneDX, SPDX, LangChain, ADK</text>
  </g>

  <!-- ================================================================== -->
  <!-- LEFT CONNECTORS: Horizontal bus pattern                            -->
  <!-- Each source right edge (x=230) -> horizontal to bus (x=252)        -->
  <!-- Vertical bus at x=252 from y=108 to y=342                         -->
  <!-- Bus -> horizontal to engine left edge (x=280) at engine midY=230  -->
  <!-- ================================================================== -->

  <g>
    <!-- Horizontal stubs: source midY -> bus x=252 -->
    <line x1="230" y1="108" x2="252" y2="108" class="conn-left"/>
    <line x1="230" y1="158" x2="252" y2="158" class="conn-left"/>
    <line x1="230" y1="204" x2="252" y2="204" class="conn-left"/>
    <line x1="230" y1="250" x2="252" y2="250" class="conn-left"/>
    <line x1="230" y1="296" x2="252" y2="296" class="conn-left"/>
    <line x1="230" y1="342" x2="252" y2="342" class="conn-left"/>

    <!-- Vertical bus line -->
    <line x1="252" y1="108" x2="252" y2="342" class="bus-left"/>

    <!-- Bus -> engine: horizontal line at engine vertical center -->
    <line x1="252" y1="230" x2="280" y2="230" class="conn-left" marker-end="url(#arrow-right-blue)"/>
  </g>

  <!-- ================================================================== -->
  <!-- CENTER: agent-bom Engine  (x=280..590, y=86..400)                 -->
  <!-- Engine height spans source+surface range for alignment             -->
  <!-- ================================================================== -->

  <g transform="translate(280, 86)">
    <!-- Engine outer box: 310 wide, 324 tall -->
    <rect width="310" height="324" rx="10" fill="#161b22" stroke="#58a6ff" stroke-width="2"/>

    <!-- Engine header bar -->
    <rect width="310" height="32" rx="10" fill="#1f6feb"/>
    <rect y="20" width="310" height="12" fill="#1f6feb"/>
    <text x="155" y="22" text-anchor="middle" font-family="system-ui, sans-serif" font-size="12" font-weight="700" fill="#ffffff">agent-bom engine</text>

    <!-- Row 1: CVE Scanning + Blast Radius (y offset = 44) -->
    <g transform="translate(12, 44)">
      <rect width="136" height="42" rx="5" fill="#1c1917" stroke="#d29922" stroke-width="1"/>
      <text x="68" y="17" text-anchor="middle" class="node-label" fill="#d29922">CVE Scanning</text>
      <text x="68" y="33" text-anchor="middle" class="node-sub">OSV + NVD + EPSS + KEV</text>
    </g>
    <g transform="translate(162, 44)">
      <rect width="136" height="42" rx="5" fill="#1c1917" stroke="#f47067" stroke-width="1"/>
      <text x="68" y="17" text-anchor="middle" class="node-label" fill="#f47067">Blast Radius</text>
      <text x="68" y="33" text-anchor="middle" class="node-sub">Agent + cred + tool map</text>
    </g>

    <!-- Row 2: Threat Frameworks + AI Enrichment (y offset = 98) -->
    <g transform="translate(12, 98)">
      <rect width="136" height="42" rx="5" fill="#1c1917" stroke="#a371f7" stroke-width="1"/>
      <text x="68" y="17" text-anchor="middle" class="node-label" fill="#a371f7">Threat Frameworks</text>
      <text x="68" y="33" text-anchor="middle" class="node-sub">OWASP + ATLAS + NIST</text>
    </g>
    <g transform="translate(162, 98)">
      <rect width="136" height="42" rx="5" fill="#1c1917" stroke="#3fb950" stroke-width="1"/>
      <text x="68" y="17" text-anchor="middle" class="node-label" fill="#3fb950">AI Enrichment</text>
      <text x="68" y="33" text-anchor="middle" class="node-sub">litellm: 100+ models</text>
    </g>

    <!-- Row 3: MCP Registry + Policy Engine (y offset = 152) -->
    <g transform="translate(12, 152)">
      <rect width="136" height="42" rx="5" fill="#1c1917" stroke="#d29922" stroke-width="1"/>
      <text x="68" y="17" text-anchor="middle" class="node-label" fill="#d29922">MCP Registry</text>
      <text x="68" y="33" text-anchor="middle" class="node-sub">427+ servers + provenance</text>
    </g>
    <g transform="translate(162, 152)">
      <rect width="136" height="42" rx="5" fill="#1c1917" stroke="#3fb950" stroke-width="1"/>
      <text x="68" y="17" text-anchor="middle" class="node-label" fill="#3fb950">Policy Engine</text>
      <text x="68" y="33" text-anchor="middle" class="node-sub">fail / warn / info gates</text>
    </g>

    <!-- Row 4: Remediation (full-width, y offset = 206) -->
    <g transform="translate(12, 206)">
      <rect width="286" height="42" rx="5" fill="#1c1917" stroke="#58a6ff" stroke-width="1"/>
      <text x="143" y="17" text-anchor="middle" class="node-label" fill="#58a6ff">Enterprise Remediation Plan</text>
      <text x="143" y="33" text-anchor="middle" class="node-sub">Named assets + impact % + risk narratives per fix</text>
    </g>

    <!-- Row 5 (bottom): Pipeline summary -->
    <g transform="translate(12, 260)">
      <rect width="286" height="48" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1" stroke-dasharray="4,3"/>
      <text x="143" y="17" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#6e7681">PIPELINE FLOW</text>
      <text x="143" y="32" text-anchor="middle" class="node-sub">Ingest -> Parse -> Scan -> Enrich -> Assess -> Remediate</text>
      <text x="143" y="43" text-anchor="middle" class="node-sub">13 MCP tools  |  100% async  |  streaming output</text>
    </g>
  </g>

  <!-- ================================================================== -->
  <!-- RIGHT CONNECTORS: Horizontal bus pattern                           -->
  <!-- Engine right edge (x=590) -> horizontal to bus (x=618) at midY    -->
  <!-- Vertical bus at x=618 from y=104 to y=390                         -->
  <!-- Bus -> horizontal stubs to each surface left edge (x=640)          -->
  <!-- ================================================================== -->

  <g>
    <!-- Engine -> bus: horizontal line at engine vertical center -->
    <line x1="590" y1="248" x2="618" y2="248" class="conn-right"/>

    <!-- Vertical bus line -->
    <line x1="618" y1="104" x2="618" y2="390" class="bus-right"/>

    <!-- Horizontal stubs: bus -> surface midY (surface left edge = 640) -->
    <line x1="618" y1="104" x2="640" y2="104" class="conn-right" marker-end="url(#arrow-right-green)"/>
    <line x1="618" y1="162" x2="640" y2="162" class="conn-right" marker-end="url(#arrow-right-green)"/>
    <line x1="618" y1="220" x2="640" y2="220" class="conn-right" marker-end="url(#arrow-right-green)"/>
    <line x1="618" y1="278" x2="640" y2="278" class="conn-right" marker-end="url(#arrow-right-green)"/>
    <line x1="618" y1="336" x2="640" y2="336" class="conn-right" marker-end="url(#arrow-right-green)"/>
    <line x1="618" y1="390" x2="640" y2="390" class="conn-right" marker-end="url(#arrow-right-green)"/>
  </g>

  <!-- ================================================================== -->
  <!-- RIGHT COLUMN: Deployment Surfaces  (x=640..890)                    -->
  <!-- ================================================================== -->

  <rect x="640" y="48" width="250" height="6" rx="3" fill="#3fb950" opacity="0.6"/>
  <text x="765" y="72" text-anchor="middle" class="section-label" fill="#3fb950">DEPLOYMENT SURFACES</text>

  <!-- Surface 1: CLI + CI/CD  (y=86, h=36, midY=104) -->
  <g transform="translate(640, 86)">
    <rect width="250" height="36" rx="6" fill="#161b22" stroke="#238636" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="18" r="5" fill="#3fb950" opacity="0.5"/>
    <text x="28" y="15" class="node-label">CLI + CI/CD Gate</text>
    <text x="28" y="28" class="node-sub">pip install, Docker, --fail-on-severity</text>
  </g>

  <!-- Surface 2: REST API  (y=140, h=44, midY=162) -->
  <g transform="translate(640, 140)">
    <rect width="250" height="44" rx="6" fill="#161b22" stroke="#238636" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="22" r="5" fill="#3fb950" opacity="0.5"/>
    <text x="28" y="15" class="node-label">REST API (FastAPI :8422)</text>
    <text x="28" y="28" class="node-sub">scan, proxy status/alerts, scorecard,</text>
    <text x="28" y="38" class="node-sub">SSE stream, registry</text>
  </g>

  <!-- Surface 3: Dashboards  (y=198, h=44, midY=220) -->
  <g transform="translate(640, 198)">
    <rect width="250" height="44" rx="6" fill="#161b22" stroke="#238636" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="22" r="5" fill="#3fb950" opacity="0.5"/>
    <text x="28" y="15" class="node-label">Dashboards</text>
    <text x="28" y="28" class="node-sub">Next.js Cloud UI (:3000)</text>
    <text x="28" y="38" class="node-sub">Streamlit dashboard (agent-bom serve)</text>
  </g>

  <!-- Surface 4: Monitoring  (y=256, h=44, midY=278) -->
  <g transform="translate(640, 256)">
    <rect width="250" height="44" rx="6" fill="#161b22" stroke="#238636" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="22" r="5" fill="#3fb950" opacity="0.5"/>
    <text x="28" y="15" class="node-label">Monitoring</text>
    <text x="28" y="28" class="node-sub">Prometheus + Grafana (metrics)</text>
    <text x="28" y="38" class="node-sub">OpenTelemetry -> Datadog / Splunk</text>
  </g>

  <!-- Surface 5: Compliance  (y=314, h=44, midY=336) -->
  <g transform="translate(640, 314)">
    <rect width="250" height="44" rx="6" fill="#161b22" stroke="#238636" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="22" r="5" fill="#3fb950" opacity="0.5"/>
    <text x="28" y="15" class="node-label">Compliance Exports</text>
    <text x="28" y="28" class="node-sub">SARIF -> GitHub Security tab</text>
    <text x="28" y="38" class="node-sub">CycloneDX 1.6, SPDX 3.0</text>
  </g>

  <!-- Surface 6: SIEM  (y=372, h=36, midY=390) -->
  <g transform="translate(640, 372)">
    <rect width="250" height="36" rx="6" fill="#161b22" stroke="#238636" stroke-width="1" opacity="0.8"/>
    <circle cx="16" cy="18" r="5" fill="#3fb950" opacity="0.5"/>
    <text x="28" y="15" class="node-label">SIEM + Alerting</text>
    <text x="28" y="28" class="node-sub">Jira, Slack, Vanta, Drata webhooks</text>
  </g>

  <!-- ================================================================== -->
  <!-- BOTTOM: How Cloud Scanning Works callout                           -->
  <!-- ================================================================== -->

  <line x1="40" y1="424" x2="880" y2="424" stroke="#30363d" stroke-width="1"/>

  <g transform="translate(30, 438)">
    <rect width="860" height="66" rx="8" fill="#161b22" stroke="#30363d" stroke-width="1"/>
    <text x="430" y="16" text-anchor="middle" font-family="system-ui, sans-serif" font-size="10" font-weight="700" fill="#8b949e" letter-spacing="0.05em">HOW CLOUD SCANNING WORKS (e.g. --aws)</text>
    <text x="430" y="32" text-anchor="middle" class="footer" fill="#8b949e">Your AWS creds (env / profile / IAM role)  ->  agent-bom calls Bedrock, Lambda, EKS, SageMaker APIs  ->  extracts packages from each resource</text>
    <text x="430" y="46" text-anchor="middle" class="footer" fill="#8b949e">->  OSV + NVD enrichment  ->  blast radius analysis  ->  threat framework tagging  ->  output to any surface above</text>
    <text x="430" y="58" text-anchor="middle" class="footer" fill="#6e7681">Read-only  ·  Uses your existing credential chain  ·  Never provisions resources  ·  --dry-run to preview API calls</text>
  </g>
</svg>