<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 540" fill="none">
  <style>
    .title { font: 700 13px system-ui, -apple-system, sans-serif; fill: #e6edf3; }
    .section-title { font: 700 10px system-ui, sans-serif; fill: #8b949e; letter-spacing: 0.06em; }
    .box-label { font: 600 10.5px system-ui, sans-serif; fill: #e6edf3; }
    .box-sub { font: 400 9px system-ui, sans-serif; fill: #8b949e; }
    .arrow-label { font: 500 8px system-ui, sans-serif; fill: #6e7681; }
  </style>
  <defs>
    <marker id="ah" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#58a6ff" opacity="0.6"/>
    </marker>
    <marker id="ag" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3fb950" opacity="0.6"/>
    </marker>
    <marker id="ao" viewBox="0 0 10 7" refX="9" refY="3.5" markerWidth="8" markerHeight="6" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#d29922" opacity="0.6"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="900" height="540" rx="12" fill="#0d1117" stroke="#30363d" stroke-width="1"/>

  <!-- Title -->
  <text x="450" y="28" text-anchor="middle" class="title">Snowflake Deployment Architecture</text>

  <!-- External Clients (left, outside boundary) -->
  <text x="100" y="60" text-anchor="middle" class="section-title">EXTERNAL CLIENTS</text>
  <rect x="20" y="74" width="150" height="36" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="95" y="90" text-anchor="middle" class="box-label">MCP Clients</text>
  <text x="95" y="102" text-anchor="middle" class="box-sub">Claude · Cursor · Codex</text>

  <rect x="20" y="120" width="150" height="36" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="95" y="136" text-anchor="middle" class="box-label">Next.js Dashboard</text>
  <text x="95" y="148" text-anchor="middle" class="box-sub">13-section cloud UI</text>

  <rect x="20" y="166" width="150" height="36" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="95" y="182" text-anchor="middle" class="box-label">CLI</text>
  <text x="95" y="194" text-anchor="middle" class="box-sub">agent-bom scan --snowflake</text>

  <!-- Snowflake Account Boundary -->
  <rect x="200" y="42" width="680" height="408" rx="10" fill="none" stroke="#29b5e8" stroke-width="1.5" stroke-dasharray="6 3" opacity="0.5"/>
  <text x="540" y="58" text-anchor="middle" class="section-title" fill="#29b5e8">SNOWFLAKE ACCOUNT</text>

  <!-- Cortex Discovery (top-left inside boundary) -->
  <rect x="220" y="72" width="290" height="180" rx="8" fill="#161b22" stroke="#29b5e8" stroke-width="1" opacity="0.8"/>
  <text x="365" y="90" text-anchor="middle" class="section-title" fill="#29b5e8">CORTEX DISCOVERY</text>

  <rect x="234" y="100" width="124" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="296" y="118" text-anchor="middle" class="box-label">Cortex Agents</text>

  <rect x="368" y="100" width="130" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="433" y="118" text-anchor="middle" class="box-label">Native MCP Servers</text>

  <rect x="234" y="136" width="124" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="296" y="154" text-anchor="middle" class="box-label">Cortex Search</text>

  <rect x="368" y="136" width="130" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="433" y="154" text-anchor="middle" class="box-label">Snowpark Containers</text>

  <rect x="234" y="172" width="124" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="296" y="190" text-anchor="middle" class="box-label">Query History</text>

  <rect x="368" y="172" width="130" height="28" rx="5" fill="#0d1117" stroke="#30363d" stroke-width="1"/>
  <text x="433" y="190" text-anchor="middle" class="box-label">Governance</text>

  <rect x="234" y="208" width="264" height="28" rx="5" fill="#0d1117" stroke="#29b5e8" stroke-width="1" opacity="0.4"/>
  <text x="366" y="226" text-anchor="middle" class="box-sub">6 discovery sources -> agents, servers, packages, tools</text>

  <!-- agent-bom API (top-right inside boundary) -->
  <rect x="570" y="84" width="180" height="76" rx="8" fill="#161b22" stroke="#58a6ff" stroke-width="1.5"/>
  <text x="660" y="108" text-anchor="middle" class="box-label" fill="#58a6ff">agent-bom API</text>
  <text x="660" y="122" text-anchor="middle" class="box-sub">FastAPI :8422</text>
  <text x="660" y="136" text-anchor="middle" class="box-sub">Scan · Registry · Compliance</text>

  <!-- Arrow: Cortex Discovery -> API (horizontal) -->
  <line x1="510" y1="122" x2="566" y2="122" stroke="#29b5e8" stroke-width="1.5" marker-end="url(#ah)" opacity="0.6"/>

  <!-- Arrow: External Clients -> API (L-shaped, routed ABOVE Cortex Discovery box) -->
  <!-- Dashed stubs from each client to the vertical collector line -->
  <line x1="170" y1="92" x2="188" y2="92" stroke="#58a6ff" stroke-width="1" stroke-dasharray="4 2" opacity="0.4"/>
  <line x1="170" y1="138" x2="188" y2="138" stroke="#58a6ff" stroke-width="1" stroke-dasharray="4 2" opacity="0.4"/>
  <line x1="170" y1="184" x2="188" y2="184" stroke="#58a6ff" stroke-width="1" stroke-dasharray="4 2" opacity="0.4"/>
  <!-- Vertical collector line connecting all three stubs -->
  <line x1="188" y1="92" x2="188" y2="184" stroke="#58a6ff" stroke-width="1" stroke-dasharray="4 2" opacity="0.4"/>
  <!-- L-shaped route: up from midpoint to y=48, then right to x=660, then down to API box top -->
  <path d="M188,92 L188,48 L660,48 L660,84" stroke="#58a6ff" stroke-width="1.5" marker-end="url(#ah)" fill="none" opacity="0.5"/>

  <!-- Snowflake Tables (center-bottom) -->
  <rect x="310" y="286" width="310" height="128" rx="8" fill="#161b22" stroke="#3fb950" stroke-width="1.5"/>
  <text x="465" y="306" text-anchor="middle" class="section-title" fill="#3fb950">SNOWFLAKE TABLES</text>

  <rect x="324" y="316" width="136" height="26" rx="5" fill="#0d1117" stroke="#3fb950" stroke-width="1" opacity="0.5"/>
  <text x="392" y="333" text-anchor="middle" class="box-label">SCAN_JOBS</text>

  <rect x="470" y="316" width="136" height="26" rx="5" fill="#0d1117" stroke="#3fb950" stroke-width="1" opacity="0.5"/>
  <text x="538" y="333" text-anchor="middle" class="box-label">FLEET_AGENTS</text>

  <rect x="324" y="350" width="136" height="26" rx="5" fill="#0d1117" stroke="#3fb950" stroke-width="1" opacity="0.5"/>
  <text x="392" y="367" text-anchor="middle" class="box-label">GATEWAY_POLICIES</text>

  <rect x="470" y="350" width="136" height="26" rx="5" fill="#0d1117" stroke="#3fb950" stroke-width="1" opacity="0.5"/>
  <text x="538" y="367" text-anchor="middle" class="box-label">POLICY_AUDIT_LOG</text>

  <rect x="324" y="384" width="282" height="18" rx="4" fill="#0d1117" stroke="#3fb950" stroke-width="1" opacity="0.3"/>
  <text x="465" y="397" text-anchor="middle" class="box-sub">+ APP_CONFIG · GOVERNANCE_FINDINGS · ACTIVITY_EVENTS</text>

  <!-- Arrow: API -> Tables (writes), vertical then horizontal then vertical -->
  <path d="M660,160 L660,210 L465,210 L465,282" stroke="#58a6ff" stroke-width="1.5" marker-end="url(#ah)" fill="none"/>
  <text x="672" y="192" class="arrow-label">writes scan results</text>

  <!-- Streamlit Dashboard (bottom-left inside boundary) -->
  <rect x="220" y="434" width="190" height="48" rx="8" fill="#161b22" stroke="#d29922" stroke-width="1.5"/>
  <text x="315" y="454" text-anchor="middle" class="box-label" fill="#d29922">Streamlit Dashboard</text>
  <text x="315" y="468" text-anchor="middle" class="box-sub">6 tabs · Jobs · Fleet · Policies · Vulns</text>

  <!-- Arrow: Tables -> Streamlit (reads) -->
  <path d="M395,414 L395,424 L315,424 L315,430" stroke="#d29922" stroke-width="1.5" marker-end="url(#ao)" fill="none"/>
  <text x="342" y="422" class="arrow-label">reads</text>

  <!-- Native App (bottom-right inside boundary) -->
  <rect x="530" y="434" width="190" height="48" rx="8" fill="#161b22" stroke="#d29922" stroke-width="1.5"/>
  <text x="625" y="454" text-anchor="middle" class="box-label" fill="#d29922">Native App</text>
  <text x="625" y="468" text-anchor="middle" class="box-sub">Marketplace · manifest.yml + setup.sql</text>

  <!-- Arrow: Tables -> Native App (reads) -->
  <path d="M535,414 L535,424 L625,424 L625,430" stroke="#d29922" stroke-width="1.5" marker-end="url(#ao)" fill="none"/>
  <text x="590" y="422" class="arrow-label">reads</text>

  <!-- Auth footer -->
  <rect x="28" y="498" width="844" height="30" rx="6" fill="#161b22" stroke="#30363d" stroke-width="1"/>
  <text x="450" y="516" text-anchor="middle" font-family="system-ui, sans-serif" font-size="9" font-weight="600" fill="#8b949e" letter-spacing="0.03em">AUTH: SNOWFLAKE_ACCOUNT + SNOWFLAKE_USER + key-pair or password  ·  API auto-detects and switches to Snowflake persistence  ·  Tables auto-created on first scan</text>
</svg>