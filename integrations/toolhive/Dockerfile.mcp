FROM python:3.12-slim

ARG VERSION=0.26.0

LABEL maintainer="agent-bom <261858605+agent-bom@users.noreply.github.com>"
LABEL description="agent-bom MCP Server: AI supply chain security scanning via MCP protocol"
LABEL org.opencontainers.image.version="${VERSION}"
LABEL org.opencontainers.image.source="https://github.com/agent-bom/agent-bom"
LABEL io.modelcontextprotocol.server.name="io.github.agent-bom/agent-bom"

WORKDIR /app

COPY pyproject.toml README.md LICENSE ./
COPY src/ ./src/

RUN pip install --no-cache-dir ".[mcp-server]"

ENV PYTHONUNBUFFERED=1

HEALTHCHECK --interval=60s --timeout=5s --retries=3 \
    CMD agent-bom --version || exit 1

ENTRYPOINT ["agent-bom", "mcp-server"]
